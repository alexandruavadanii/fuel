::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
: Copyright (c) 2018 Mirantis Inc., Enea AB and others.
:
: All rights reserved. This program and the accompanying materials
: are made available under the terms of the Apache License, Version 2.0
: which accompanies this distribution, and is available at
: http://www.apache.org/licenses/LICENSE-2.0
::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
From: Michael Polenchuk <mpolenchuk@mirantis.com>
Date: Mon, 12 Mar 2018 16:32:50 +0400
Subject: [PATCH] Apply opendaylight client state on compute only

Change-Id: I07cd760fdb4ce84aba21450af9246c8c9128118f

diff --git a/neutron/compute.sls b/neutron/compute.sls
index 418282d..7ff136a 100644
--- a/neutron/compute.sls
+++ b/neutron/compute.sls
@@ -2,6 +2,10 @@
 {%- if compute.enabled %}

 {% if compute.backend.engine == "ml2" %}
+{%- if compute.opendaylight is defined %}
+include:
+  - .opendaylight.client
+{%- else %}
 neutron_compute_packages:
   pkg.installed:
   - names: {{ compute.pkgs }}
@@ -243,9 +247,6 @@ rabbitmq_ca_neutron_compute:
 {%- endif %}
 {%- endif %}

-{%- if compute.opendaylight is defined %}
-include:
-  - .opendaylight.client
 {%- endif %}

 {%- elif compute.backend.engine == "ovn" %}
